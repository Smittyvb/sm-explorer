<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SM Explorer</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        background-color: #e6fee6;
        text-align: center;
      }
      h1 {
        font-size: 3.5vw;
        font-weight: bold;
        margin: 0;
        max-height: 1.9em;
      }
      nav {
        height: 5vw;
        min-height: 1.35em;
        background-color: #79f179;
        max-height: 3em;
      }
      #usage {
        margin-top: 0.66em;
        margin-bottom: 0.66em;
        color: #007700;
        text-align: center;
      }
      #query {
        width: 66.666vw;
        height: 3rem;
        font-family: monospace;
        font-size: 1.5em;
        border: 1px solid #09ff09;
        margin-bottom: 1em;
      }
      .raw-data {
        font-family: monospace;
        color: black;
        background-color: #f7f7f7;
        box-shadow: 2px 2px 2px 0px #444;
        border: 1px solid #777;
        margin-right: 3px;
      }
      #loader {
        width: 100px;
        height: 100px;
        background-color: transparent;
        border-radius: 50%;
        animation-name: loader-rotate;
        animation-iteration-count: infinite;
        animation-duration: 2.5s;
        animation-timing-function: cubic-bezier(0.4, 0.07, 0.64, 0.92);
        margin-top: 1em;
        border: 1em solid green;
        border-top-style: double;
        margin: 0 auto;
      }
      .transaction {
        background-color: #7eff88;
        border-radius: 10px;
        height: 5em;
        width: 25em;
        border: 0.2em solid black;
        margin: 0 auto;
        text-align: left;
        padding: 1em;
      }
      .username {
        font-weight: bold;
      }
      @keyframes loader-rotate { 
        from { 
          transform: rotate(0deg);
        }
        50% {
        }
        to { 
          transform: rotate(1800deg);
        }
      }
      @media (max-width: 385px) {
        h1 {
          font-size: 1.5em;
        }
        nav {
          height: 2.14285714286em;
        }
        #query {
          width: 80vw;
        }
      }
      @media (max-width: 300px) {
        h1 {
          font-size: 1em;
        }
        nav {
          height: 1.42857142857em;
        }
        #query {
          width: 94vw;
        }
      }
      @media (min-width: 1100px) {
        h1 {
          font-size: 2.25em;
        }
      }
    </style>
    <script>
      class Transaction {
        constructor(tx) {
          //the hash of the transaction
          this.id = tx.id;
          
          //some "virtual" transactions don't get put on-chain
          this.virtual = this.id.indexOf("sm_") === 0;
          
          //hash of block when the transaction occured
          this.blockID = tx.block_id;
          
          //hash of block before the transaction occured
          this.prevBlockID = tx.prev_block_id;
          
          //type of transaction, e.g. sm_open_pack, sm_find_match, sm_claim_reward, etc.
          this.type = tx.type;
          
          //player who caused the transaction to occur
          this.player = tx.player;
          
          //what is supposted to happen in the transaction
          this.data = JSON.parse(tx.data);
          
          //results of performing the transaction, sometimes is null (such as for sm_claim_reward)
          this.result = JSON.parse(tx.result);
          
          //boolean, true if the transaction worked and was valid, otherwise false
          this.success = tx.success;
          
          //null if it worked, otherwise an object like {error: "It didn't work"}
          this.error = tx.error;
          
          //block number when the transaction occured
          this.block = tx.block_num;
          
          //date of when the transaction occured
          this.date = tx.created_date;
                    
          //price data as of the transaction
          this.priceData = {sbd: tx.sbd_price, steem: tx.steem_price};
          
          //original raw transaction
          this.raw = tx;
        }
        toHTML() {
          return `
            <div class="transaction">
              <span class="username">${this.player}</span>
            </div>
          `;
        }
        toExpandedHTML() {
          //extra data about transaction
        }
      }
      window.addEventListener("load", function () {
        document.getElementById("content").innerHTML = new Transaction({
          "id": "0fb36507f2dba5e3aadd18284a62e6df480db770",
          "block_id": "01ab612c927b1e5637e1b71948f6d54fc0cfa81b",
          "prev_block_id": "01ab612b58f3a41f20a9b336028181d5d96d9d15",
          "type": "sm_find_match",
          "player": "smitop",
          "data": "{\"team_hash\": \"4d470facfc07bf7c7fe515f01e810407\", \"ruleset\": \"Taking Sides\", \"match_type\": \"Ranked\", \"mana_cap\": 15, \"summoner_level\": 1}",
          "success": true,
          "error": null,
          "block_num": 28008748,
          "created_date": "2018-11-25T12:09:45.784Z",
          "result": null,
          "steem_price": "0.327729",
          "sbd_price": "0.835209"
        }).toHTML();
        document.getElementById("loader").style.display = "none";
      });
    </script>
  </head>
  <body>
    <nav>
      <h1>Steem Monsters Explorer</h1>
    </nav>
    <div id="usage">
      Enter a Steem username, block number, purchase ID (starts with <span class="raw-data">P-</span>), booster pack ID (starts with <span class="raw-data">B-</span>), or battle ID...
    </div>
    <input type="text" id="query" />
    <div id="loader">
    </div>
    <div id="content"></div>
  </body>
</html>
